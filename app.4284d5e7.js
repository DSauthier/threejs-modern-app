!function(e){function t(t){for(var n,i,s=t[0],u=t[1],c=t[2],p=0,d=[];p<s.length;p++)i=s[p],a[i]&&d.push(a[i][0]),a[i]=0;for(n in u)Object.prototype.hasOwnProperty.call(u,n)&&(e[n]=u[n]);for(l&&l(t);d.length;)d.shift()();return o.push.apply(o,c||[]),r()}function r(){for(var e,t=0;t<o.length;t++){for(var r=o[t],n=!0,s=1;s<r.length;s++){var u=r[s];0!==a[u]&&(n=!1)}n&&(o.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},a={0:0},o=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var s=window.webpackJsonp=window.webpackJsonp||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=u;o.push([245,1]),r()}({245:function(e,t,r){"use strict";r.r(t);r(163),r(53),r(166),r(93);var n=r(0),a=r(64),o=r.n(a),i=(r(54),r(75),r(98),r(99),r(57),r(21),r(43),r(105),r(59),r(25),r(44),r(106),r(61),r(108),r(156)),s=r.n(i),u=r(157),c=r.n(u),l=r(158),p=r.n(l),d=r(159),f=r.n(d),h=r(160),v=r.n(h);r(204),r(116),r(32),r(62),r(117);n.CopyShader={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")};var m,g,b,y=n.CopyShader;n.Pass=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1},Object.assign(n.Pass.prototype,{setSize:function(e,t){},render:function(e,t,r,n,a){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),n.Pass.FullScreenQuad=(m=new n.zb(-1,1,1,-1,0,1),g=new n.Eb(2,2),b=function(e){this._mesh=new n.ib(g,e)},Object.defineProperty(b.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(b.prototype,{render:function(e){e.render(this._mesh,m)}}),b);var w=n.Pass;n.Pass=w,n.ShaderPass=function(e,t){n.Pass.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof n.Vb?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=n.ic.clone(e.uniforms),this.material=new n.Vb({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new n.Pass.FullScreenQuad(this.material)},n.ShaderPass.prototype=Object.assign(Object.create(n.Pass.prototype),{constructor:n.ShaderPass,render:function(e,t,r,n,a){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}});var T=n.ShaderPass;n.CopyShader=y,n.ShaderPass=T,n.EffectComposer=function(e,t){if(this.renderer=e,void 0===t){var r={minFilter:n.X,magFilter:n.X,format:n.Kb,stencilBuffer:!1},a=e.getDrawingBufferSize(new n.kc);(t=new n.pc(a.width,a.height,r)).texture.name="EffectComposer.rt1"}this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===n.CopyShader&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),void 0===n.ShaderPass&&console.error("THREE.EffectComposer relies on THREE.ShaderPass"),this.copyPass=new n.ShaderPass(n.CopyShader),this._previousFrameTime=Date.now()},Object.assign(n.EffectComposer.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e);var t=this.renderer.getDrawingBufferSize(new n.kc);e.setSize(t.width,t.height)},insertPass:function(e,t){this.passes.splice(t,0,e)},isLastEnabledPass:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(e){void 0===e&&(e=.001*(Date.now()-this._previousFrameTime)),this._previousFrameTime=Date.now();var t,r,a=this.renderer.getRenderTarget(),o=!1,i=this.passes.length;for(r=0;r<i;r++)if(!1!==(t=this.passes[r]).enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,o),t.needsSwap){if(o){var s=this.renderer.context;s.stencilFunc(s.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),s.stencilFunc(s.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==n.MaskPass&&(t instanceof n.MaskPass?o=!0:t instanceof n.ClearMaskPass&&(o=!1))}this.renderer.setRenderTarget(a)},reset:function(e){if(void 0===e){var t=this.renderer.getDrawingBufferSize(new n.kc);(e=this.renderTarget1.clone()).setSize(t.width,t.height)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this.renderTarget1.setSize(e,t),this.renderTarget2.setSize(e,t);for(var r=0;r<this.passes.length;r++)this.passes[r].setSize(e,t)}}),n.Pass=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1},Object.assign(n.Pass.prototype,{setSize:function(e,t){},render:function(e,t,r,n,a){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),n.Pass.FullScreenQuad=function(){var e=new n.zb(-1,1,1,-1,0,1),t=new n.Eb(2,2),r=function(e){this._mesh=new n.ib(t,e)};return Object.defineProperty(r.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(r.prototype,{render:function(t){t.render(this._mesh,e)}}),r}();var x=n.EffectComposer;n.Pass=w,n.RenderPass=function(e,t,r,a,o){n.Pass.call(this),this.scene=e,this.camera=t,this.overrideMaterial=r,this.clearColor=a,this.clearAlpha=void 0!==o?o:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1},n.RenderPass.prototype=Object.assign(Object.create(n.Pass.prototype),{constructor:n.RenderPass,render:function(e,t,r,n,a){var o,i,s=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(o=e.getClearColor().getHex(),i=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:r),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(o,i),this.scene.overrideMaterial=null,e.autoClear=s}});var S=n.RenderPass;function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){R(e,t,r[t])})}return e}function R(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function E(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function L(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var _=0;function C(e){return"__private_"+_+++"_"+e}var O=function(){function e(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=r.background,i=void 0===a?"#000":a,u=r.backgroundAlpha,l=void 0===u?1:u,d=r.fov,h=void 0===d?45:d,m=r.near,g=void 0===m?.01:m,b=r.far,y=void 0===b?100:b,w=E(r,["background","backgroundAlpha","fov","near","far"]);if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,A,{writable:!0,value:[]}),Object.defineProperty(this,D,{writable:!0,value:new n.lc}),Object.defineProperty(this,I,{writable:!0,value:void 0}),Object.defineProperty(this,F,{writable:!0,value:void 0}),this.resize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.width,n=void 0===r?window.innerWidth:r,a=e.height,o=void 0===a?window.innerHeight:a,i=e.pixelRatio,s=void 0===i?Math.min(t.maxPixelRatio,window.devicePixelRatio):i;return t.width=n,t.height=o,t.pixelRatio=s,t.renderer.getPixelRatio()!==s&&t.renderer.setPixelRatio(s),t.renderer.setSize(n,o),t.camera.isPerspectiveCamera&&(t.camera.aspect=n/o),t.camera.updateProjectionMatrix(),t.composer&&t.composer.setSize(s*n,s*o),t.scene.traverse(function(e){"function"==typeof e.resize&&e.resize({width:n,height:o,pixelRatio:s})}),t.draw(),t},this.saveScreenshot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.width,n=void 0===r?2560:r,a=e.height,o=void 0===a?1440:a,i=e.fileName,s=void 0===i?"image.png":i;t.resize({width:n,height:o,pixelRatio:1}),t.draw();var u=t.canvas.toDataURL("image/png");t.resize(),t.draw(),function(e,t){var r=p()(t),n=document.createElement("a");n.download=e,n.href=window.URL.createObjectURL(r),n.onclick=setTimeout(function(){window.URL.revokeObjectURL(r),n.removeAttribute("href")},0),n.click()}(s,u)},this.update=function(e,r){return t.orbitControls&&(t.orbitControls.update(),t.camera.up.fromArray(t.orbitControls.up),t.camera.position.fromArray(t.orbitControls.position),L(t,D)[D].fromArray(t.orbitControls.target),t.camera.lookAt(L(t,D)[D])),t.scene.traverse(function(t){"function"==typeof t.update&&t.update(e,r)}),t.world&&(t.world.step(e),t.world.bodies.forEach(function(t){"function"==typeof t.update&&t.update(e,r)})),t.tween&&t.tween.update(),L(t,A)[A].forEach(function(t){return t(e,r)}),t},this.draw=function(){return t.composer?(t.composer.passes.forEach(function(e,t,r){var n=t===r.length-1;e.renderToScreen=!!n}),t.composer.render()):t.renderer.render(t.scene,t.camera),t},this.start=function(){if(null===L(t,I)[I])return L(t,I)[I]=window.requestAnimationFrame(t.animate),t.isRunning=!0,t},this.stop=function(){if(null!==L(t,I)[I])return window.cancelAnimationFrame(L(t,I)[I]),L(t,I)[I]=null,t.isRunning=!1,t},this.animate=function(){if(t.isRunning){window.requestAnimationFrame(t.animate),t.stats&&t.stats.begin();var e=performance.now(),r=Math.min(t.maxDeltaTime,(e-L(t,F)[F])/1e3);t.time+=r,L(t,F)[F]=e,t.update(r,t.time),t.draw(),t.stats&&t.stats.end()}},this.traverse=function(e){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];t.scene.traverse(function(t){"function"==typeof t[e]&&t[e].apply(t,n)})},this.renderer=new n.rc(M({antialias:!0,alpha:!1,preserveDrawingBuffer:!0,failIfMajorPerformanceCaveat:!0},w)),this.renderer.sortObjects=!1,this.canvas=this.renderer.domElement,this.renderer.setClearColor(i,l),this.maxPixelRatio=w.maxPixelRatio||2,this.maxDeltaTime=w.maxDeltaTime||1/30,this.camera=new n.Db(h,1,g,y),this.scene=new n.Tb,this.time=0,this.isRunning=!1,L(this,F)[F]=performance.now(),L(this,I)[I]=null,window.addEventListener("resize",this.resize),window.addEventListener("orientationchange",this.resize),this.resize(),this.touchHandler=c()(this.canvas,{target:this.canvas,filtered:!0}),this.touchHandler.on("start",function(e,r){return t.traverse("onPointerDown",e,r)}),this.touchHandler.on("move",function(e,r){return t.traverse("onPointerMove",e,r)}),this.touchHandler.on("end",function(e,r){return t.traverse("onPointerUp",e,r)}),w.postprocessing&&(this.composer=new x(this.renderer),this.composer.addPass(new S(this.scene,this.camera))),w.orbitControls&&(this.orbitControls=s()(M({element:this.canvas,parent:window,distance:4},w.orbitControls instanceof Object?w.orbitControls:{}))),w.world&&(this.world=w.world),w.tween&&(this.tween=w.tween),w.showFps&&(this.stats=new f.a,this.stats.showPanel(0),document.body.appendChild(this.stats.dom)),w.controls){var T=o()(w.controls);this.controls=w.hideControls?T:v()(T)}}var t,r,a;return t=e,(r=[{key:"onUpdate",value:function(e){L(this,A)[A].push(e)}}])&&P(t.prototype,r),a&&P(t,a),e}(),A=C("updateListeners"),D=C("tmpTarget"),I=C("rafID"),F=C("lastTime");r(80),r(81),r(205),r(206),r(207),r(119),r(63),r(214),r(83);var U=r(161),j=r.n(U),k=r(66),G=r.n(k),H=r(65),N=r.n(H);r(216),r(217),r(124),r(218),r(219),r(127),r(128),r(129),r(227),r(228),r(229),r(131),r(230),r(132),r(133),r(134),r(135),r(136),r(137),r(138),r(139),r(140),r(141),r(142),r(143),r(144),r(145),r(146),r(147),r(148),r(149),r(150),r(151),r(152),r(153),r(154);function B(e){return(B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.GLTFLoader=function(){function e(e){this.manager=void 0!==e?e:n.t,this.dracoLoader=null}function t(){var e={};return{get:function(t){return e[t]},add:function(t,r){e[t]=r},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,r,a){var o,i=this;o=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:n.cb.extractUrlBase(e),i.manager.itemStart(e);var s=function(t){a?a(t):console.error(t),i.manager.itemError(e),i.manager.itemEnd(e)},u=new n.B(i.manager);u.setPath(this.path),u.setResponseType("arraybuffer"),u.load(e,function(r){try{i.parse(r,o,function(r){t(r),i.manager.itemEnd(e)},s)}catch(e){s(e)}},r,s)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},parse:function(e,t,u,c){var h,v={};if("string"==typeof e)h=e;else if(n.cb.decodeText(new Uint8Array(e,0,4))===s){try{v[r.KHR_BINARY_GLTF]=new l(e)}catch(e){return void(c&&c(e))}h=v[r.KHR_BINARY_GLTF].content}else h=n.cb.decodeText(new Uint8Array(e));var m=JSON.parse(h);if(void 0===m.asset||m.asset.version[0]<2)c&&c(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(m.extensionsUsed)for(var g=0;g<m.extensionsUsed.length;++g){var b=m.extensionsUsed[g],y=m.extensionsRequired||[];switch(b){case r.KHR_LIGHTS_PUNCTUAL:v[b]=new o(m);break;case r.KHR_MATERIALS_UNLIT:v[b]=new i(m);break;case r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:v[b]=new f(m);break;case r.KHR_DRACO_MESH_COMPRESSION:v[b]=new p(m,this.dracoLoader);break;case r.MSFT_TEXTURE_DDS:v[r.MSFT_TEXTURE_DDS]=new a;break;case r.KHR_TEXTURE_TRANSFORM:v[r.KHR_TEXTURE_TRANSFORM]=new d(m);break;default:y.indexOf(b)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+b+'".')}}new H(m,v,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}).parse(u,c)}}};var r={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function a(){if(!n.DDSLoader)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=r.MSFT_TEXTURE_DDS,this.ddsLoader=new n.DDSLoader}function o(e){this.name=r.KHR_LIGHTS_PUNCTUAL;var t=e.extensions&&e.extensions[r.KHR_LIGHTS_PUNCTUAL]||{};this.lightDefs=t.lights||[]}function i(e){this.name=r.KHR_MATERIALS_UNLIT}o.prototype.loadLight=function(e){var t,r=this.lightDefs[e],a=new n.k(16777215);void 0!==r.color&&a.fromArray(r.color);var o=void 0!==r.range?r.range:0;switch(r.type){case"directional":(t=new n.u(a)).target.position.set(0,0,-1),t.add(t.target);break;case"point":(t=new n.Fb(a)).distance=o;break;case"spot":(t=new n.Zb(a)).distance=o,r.spot=r.spot||{},r.spot.innerConeAngle=void 0!==r.spot.innerConeAngle?r.spot.innerConeAngle:0,r.spot.outerConeAngle=void 0!==r.spot.outerConeAngle?r.spot.outerConeAngle:Math.PI/4,t.angle=r.spot.outerConeAngle,t.penumbra=1-r.spot.innerConeAngle/r.spot.outerConeAngle,t.target.position.set(0,0,-1),t.add(t.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+r.type+'".')}return t.position.set(0,0,0),t.decay=2,void 0!==r.intensity&&(t.intensity=r.intensity),t.name=r.name||"light_"+e,Promise.resolve(t)},i.prototype.getMaterialType=function(e){return n.jb},i.prototype.extendParams=function(e,t,r){var a=[];e.color=new n.k(1,1,1),e.opacity=1;var o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){var i=o.baseColorFactor;e.color.fromArray(i),e.opacity=i[3]}void 0!==o.baseColorTexture&&a.push(r.assignTexture(e,"map",o.baseColorTexture))}return Promise.all(a)};var s="glTF",u=12,c={JSON:1313821514,BIN:5130562};function l(e){this.name=r.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,u);if(this.header={magic:n.cb.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==s)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var a=new DataView(e,u),o=0;o<a.byteLength;){var i=a.getUint32(o,!0);o+=4;var l=a.getUint32(o,!0);if(o+=4,l===c.JSON){var p=new Uint8Array(e,u+o,i);this.content=n.cb.decodeText(p)}else if(l===c.BIN){var d=u+o;this.body=e.slice(d,d+i)}o+=i}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function p(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=r.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t}function d(e){this.name=r.KHR_TEXTURE_TRANSFORM}function f(){return{name:r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return n.Vb},extendParams:function(e,t,r){var a=t.extensions[this.name],o=n.Ub.standard,i=n.ic.clone(o.uniforms),s=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),u=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),c=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),l=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),p=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),d=o.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",s).replace("#include <metalnessmap_pars_fragment>",u).replace("#include <roughnessmap_fragment>",c).replace("#include <metalnessmap_fragment>",l).replace("#include <lights_physical_fragment>",p);delete i.roughness,delete i.metalness,delete i.roughnessMap,delete i.metalnessMap,i.specular={value:(new n.k).setHex(1118481)},i.glossiness={value:.5},i.specularMap={value:null},i.glossinessMap={value:null},e.vertexShader=o.vertexShader,e.fragmentShader=d,e.uniforms=i,e.defines={STANDARD:""},e.color=new n.k(1,1,1),e.opacity=1;var f=[];if(Array.isArray(a.diffuseFactor)){var h=a.diffuseFactor;e.color.fromArray(h),e.opacity=h[3]}if(void 0!==a.diffuseTexture&&f.push(r.assignTexture(e,"map",a.diffuseTexture)),e.emissive=new n.k(0,0,0),e.glossiness=void 0!==a.glossinessFactor?a.glossinessFactor:1,e.specular=new n.k(1,1,1),Array.isArray(a.specularFactor)&&e.specular.fromArray(a.specularFactor),void 0!==a.specularGlossinessTexture){var v=a.specularGlossinessTexture;f.push(r.assignTexture(e,"glossinessMap",v)),f.push(r.assignTexture(e,"specularMap",v))}return Promise.all(f)},createMaterial:function(e){var t=new n.Vb({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var r=this.specularGlossinessParams,n=0,a=r.length;n<a;n++)t[r[n]]=e[r[n]];return t},refreshUniforms:function(e,t,r,n,a,o){if(!0===a.isGLTFSpecularGlossinessMaterial){var i,s=a.uniforms,u=a.defines;s.opacity.value=a.opacity,s.diffuse.value.copy(a.color),s.emissive.value.copy(a.emissive).multiplyScalar(a.emissiveIntensity),s.map.value=a.map,s.specularMap.value=a.specularMap,s.alphaMap.value=a.alphaMap,s.lightMap.value=a.lightMap,s.lightMapIntensity.value=a.lightMapIntensity,s.aoMap.value=a.aoMap,s.aoMapIntensity.value=a.aoMapIntensity,a.map?i=a.map:a.specularMap?i=a.specularMap:a.displacementMap?i=a.displacementMap:a.normalMap?i=a.normalMap:a.bumpMap?i=a.bumpMap:a.glossinessMap?i=a.glossinessMap:a.alphaMap?i=a.alphaMap:a.emissiveMap&&(i=a.emissiveMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),s.uvTransform.value.copy(i.matrix)),a.envMap&&(s.envMap.value=a.envMap,s.envMapIntensity.value=a.envMapIntensity,s.flipEnvMap.value=a.envMap.isCubeTexture?-1:1,s.reflectivity.value=a.reflectivity,s.refractionRatio.value=a.refractionRatio,s.maxMipLevel.value=e.properties.get(a.envMap).__maxMipLevel),s.specular.value.copy(a.specular),s.glossiness.value=a.glossiness,s.glossinessMap.value=a.glossinessMap,s.emissiveMap.value=a.emissiveMap,s.bumpMap.value=a.bumpMap,s.normalMap.value=a.normalMap,s.displacementMap.value=a.displacementMap,s.displacementScale.value=a.displacementScale,s.displacementBias.value=a.displacementBias,null!==s.glossinessMap.value&&void 0===u.USE_GLOSSINESSMAP&&(u.USE_GLOSSINESSMAP="",u.USE_ROUGHNESSMAP=""),null===s.glossinessMap.value&&void 0!==u.USE_GLOSSINESSMAP&&(delete u.USE_GLOSSINESSMAP,delete u.USE_ROUGHNESSMAP)}}}}function h(e,t,r,a){n.N.call(this,e,t,r,a)}p.prototype.decodePrimitive=function(e,t){var r=this.json,n=this.dracoLoader,a=e.extensions[this.name].bufferView,o=e.extensions[this.name].attributes,i={},s={},u={};for(var c in o){var l=P[c]||c.toLowerCase();i[l]=o[c]}for(c in e.attributes){l=P[c]||c.toLowerCase();if(void 0!==o[c]){var p=r.accessors[e.attributes[c]],d=S[p.componentType];u[l]=d,s[l]=!0===p.normalized}}return t.getDependency("bufferView",a).then(function(e){return new Promise(function(t){n.decodeDracoFile(e,function(e){for(var r in e.attributes){var n=e.attributes[r],a=s[r];void 0!==a&&(n.normalized=a)}t(e)},i,u)})})},d.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},h.prototype=Object.create(n.N.prototype),h.prototype.constructor=h,h.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,r=this.sampleValues,n=this.valueSize,a=e*n*3+n,o=0;o!==n;o++)t[o]=r[a+o];return t},h.prototype.beforeStart_=h.prototype.copySampleValue_,h.prototype.afterEnd_=h.prototype.copySampleValue_,h.prototype.interpolate_=function(e,t,r,n){for(var a=this.resultBuffer,o=this.sampleValues,i=this.valueSize,s=2*i,u=3*i,c=n-t,l=(r-t)/c,p=l*l,d=p*l,f=e*u,h=f-u,v=-2*d+3*p,m=d-p,g=1-v,b=m-p+l,y=0;y!==i;y++){var w=o[h+y+i],T=o[h+y+s]*c,x=o[f+y+i],S=o[f+y]*c;a[y]=g*w+b*T+v*x+m*S}return a};var v,m=0,g=1,b=2,y=3,w=4,T=5,x=6,S=(Number,n.gb,n.hb,n.kc,n.lc,n.mc,n.ec,{5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array}),M={9728:n.mb,9729:n.X,9984:n.ob,9985:n.Z,9986:n.nb,9987:n.Y},R={33071:n.i,33648:n.lb,10497:n.Rb},E=(n.d,n.D,n.pb,n.Q,n.z,n.R,n.G,n.rb,n.G,n.b,n.a,n.dc,n.Sb,n.sc,n.ub,n.cc,n.yb,n.ac,n.xb,n.w,n.vb,n.x,n.wb,n.bc,{SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}),P={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},L={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},_={CUBICSPLINE:void 0,LINEAR:n.P,STEP:n.O},C="OPAQUE",O="MASK",A="BLEND",D={"image/png":n.Kb,"image/jpeg":n.Nb};function I(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e}function F(e,t,r){for(var n in r.extensions)void 0===e[n]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[n]=r.extensions[n])}function U(e,t){void 0!==t.extras&&("object"===B(t.extras)?e.userData=t.extras:console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function j(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var r=0,n=t.weights.length;r<n;r++)e.morphTargetInfluences[r]=t.weights[r];if(t.extras&&Array.isArray(t.extras.targetNames)){var a=t.extras.targetNames;if(e.morphTargetInfluences.length===a.length){e.morphTargetDictionary={};for(r=0,n=a.length;r<n;r++)e.morphTargetDictionary[a[r]]=r}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function k(e){for(var t="",r=Object.keys(e).sort(),n=0,a=r.length;n<a;n++)t+=r[n]+":"+e[r[n]]+";";return t}function G(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,r=e.itemSize,a=e.array.slice(0,t*r),o=0,i=0;o<t;++o)a[i++]=e.getX(o),r>=2&&(a[i++]=e.getY(o)),r>=3&&(a[i++]=e.getZ(o)),r>=4&&(a[i++]=e.getW(o));return new n.g(a,r,e.normalized)}return e.clone()}function H(e,r,a){this.json=e||{},this.extensions=r||{},this.options=a||{},this.cache=new t,this.primitiveCache={},this.textureLoader=new n.fc(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new n.B(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}function N(e,t,r){var n=t.attributes,a=[];function o(t,n){return r.getDependency("accessor",t).then(function(t){e.addAttribute(n,t)})}for(var i in n){var s=P[i]||i.toLowerCase();s in e.attributes||a.push(o(n[i],s))}if(void 0!==t.indices&&!e.index){var u=r.getDependency("accessor",t.indices).then(function(t){e.setIndex(t)});a.push(u)}return U(e,t),Promise.all(a).then(function(){return void 0!==t.targets?function(e,t,r){for(var n=!1,a=!1,o=0,i=t.length;o<i&&(void 0!==(c=t[o]).POSITION&&(n=!0),void 0!==c.NORMAL&&(a=!0),!n||!a);o++);if(!n&&!a)return Promise.resolve(e);var s=[],u=[];for(o=0,i=t.length;o<i;o++){var c=t[o];if(n){var l=void 0!==c.POSITION?r.getDependency("accessor",c.POSITION):e.attributes.position;s.push(l)}a&&(l=void 0!==c.NORMAL?r.getDependency("accessor",c.NORMAL):e.attributes.normal,u.push(l))}return Promise.all([Promise.all(s),Promise.all(u)]).then(function(r){for(var o=r[0],i=r[1],s=0,u=o.length;s<u;s++)e.attributes.position!==o[s]&&(o[s]=G(o[s]));for(s=0,u=i.length;s<u;s++)e.attributes.normal!==i[s]&&(i[s]=G(i[s]));for(s=0,u=t.length;s<u;s++){var c=t[s],l="morphTarget"+s;if(n&&void 0!==c.POSITION){var p=o[s];p.name=l;for(var d=e.attributes.position,f=0,h=p.count;f<h;f++)p.setXYZ(f,p.getX(f)+d.getX(f),p.getY(f)+d.getY(f),p.getZ(f)+d.getZ(f))}if(a&&void 0!==c.NORMAL){var v=i[s];v.name=l;var m=e.attributes.normal;for(f=0,h=v.count;f<h;f++)v.setXYZ(f,v.getX(f)+m.getX(f),v.getY(f)+m.getY(f),v.getZ(f)+m.getZ(f))}}return n&&(e.morphAttributes.position=o),a&&(e.morphAttributes.normal=i),e})}(e,t.targets,r):e})}return H.prototype.parse=function(e,t){var r=this,n=this.json,a=this.extensions;this.cache.removeAll(),this.markDefs(),Promise.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(t){var o={scene:t[0][n.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:n.asset,parser:r,userData:{}};F(a,o,n),e(o)}).catch(t)},H.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],r=this.json.meshes||[],n={},a={},o=0,i=t.length;o<i;o++)for(var s=t[o].joints,u=0,c=s.length;u<c;u++)e[s[u]].isBone=!0;for(var l=0,p=e.length;l<p;l++){var d=e[l];void 0!==d.mesh&&(void 0===n[d.mesh]&&(n[d.mesh]=a[d.mesh]=0),n[d.mesh]++,void 0!==d.skin&&(r[d.mesh].isSkinnedMesh=!0))}this.json.meshReferences=n,this.json.meshUses=a},H.prototype.getDependency=function(e,t){var n=e+":"+t,a=this.cache.get(n);if(!a){switch(e){case"scene":a=this.loadScene(t);break;case"node":a=this.loadNode(t);break;case"mesh":a=this.loadMesh(t);break;case"accessor":a=this.loadAccessor(t);break;case"bufferView":a=this.loadBufferView(t);break;case"buffer":a=this.loadBuffer(t);break;case"material":a=this.loadMaterial(t);break;case"texture":a=this.loadTexture(t);break;case"skin":a=this.loadSkin(t);break;case"animation":a=this.loadAnimation(t);break;case"camera":a=this.loadCamera(t);break;case"light":a=this.extensions[r.KHR_LIGHTS_PUNCTUAL].loadLight(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,a)}return a},H.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var r=this,n=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(n.map(function(t,n){return r.getDependency(e,n)})),this.cache.add(e,t)}return t},H.prototype.loadBuffer=function(e){var t=this.json.buffers[e],n=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[r.KHR_BINARY_GLTF].body);var a=this.options;return new Promise(function(e,r){n.load(I(t.uri,a.path),e,void 0,function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))})})},H.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var r=t.byteLength||0,n=t.byteOffset||0;return e.slice(n,n+r)})},H.prototype.loadAccessor=function(e){var t=this,r=this.json,a=this.json.accessors[e];if(void 0===a.bufferView&&void 0===a.sparse)return Promise.resolve(null);var o=[];return void 0!==a.bufferView?o.push(this.getDependency("bufferView",a.bufferView)):o.push(null),void 0!==a.sparse&&(o.push(this.getDependency("bufferView",a.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",a.sparse.values.bufferView))),Promise.all(o).then(function(e){var o,i,s=e[0],u=E[a.type],c=S[a.componentType],l=c.BYTES_PER_ELEMENT,p=l*u,d=a.byteOffset||0,f=void 0!==a.bufferView?r.bufferViews[a.bufferView].byteStride:void 0,h=!0===a.normalized;if(f&&f!==p){var v="InterleavedBuffer:"+a.bufferView+":"+a.componentType,m=t.cache.get(v);m||(o=new c(s),m=new n.L(o,f/l),t.cache.add(v,m)),i=new n.M(m,u,d/l,h)}else o=null===s?new c(a.count*u):new c(s,d,a.count*u),i=new n.g(o,u,h);if(void 0!==a.sparse){var g=E.SCALAR,b=S[a.sparse.indices.componentType],y=a.sparse.indices.byteOffset||0,w=a.sparse.values.byteOffset||0,T=new b(e[1],y,a.sparse.count*g),x=new c(e[2],w,a.sparse.count*u);null!==s&&i.setArray(i.array.slice());for(var M=0,R=T.length;M<R;M++){var P=T[M];if(i.setX(P,x[M*u]),u>=2&&i.setY(P,x[M*u+1]),u>=3&&i.setZ(P,x[M*u+2]),u>=4&&i.setW(P,x[M*u+3]),u>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return i})},H.prototype.loadTexture=function(e){var t,a=this,o=this.json,i=this.options,s=this.textureLoader,u=window.URL||window.webkitURL,c=o.textures[e],l=c.extensions||{},p=(t=l[r.MSFT_TEXTURE_DDS]?o.images[l[r.MSFT_TEXTURE_DDS].source]:o.images[c.source]).uri,d=!1;return void 0!==t.bufferView&&(p=a.getDependency("bufferView",t.bufferView).then(function(e){d=!0;var r=new Blob([e],{type:t.mimeType});return p=u.createObjectURL(r)})),Promise.resolve(p).then(function(e){var t=n.bb.Handlers.get(e);return t||(t=l[r.MSFT_TEXTURE_DDS]?a.extensions[r.MSFT_TEXTURE_DDS].ddsLoader:s),new Promise(function(r,n){t.load(I(e,i.path),r,void 0,n)})}).then(function(e){!0===d&&u.revokeObjectURL(p),e.flipY=!1,void 0!==c.name&&(e.name=c.name),t.mimeType in D&&(e.format=D[t.mimeType]);var r=(o.samplers||{})[c.sampler]||{};return e.magFilter=M[r.magFilter]||n.X,e.minFilter=M[r.minFilter]||n.Y,e.wrapS=R[r.wrapS]||n.Rb,e.wrapT=R[r.wrapT]||n.Rb,e})},H.prototype.assignTexture=function(e,t,a){var o=this;return this.getDependency("texture",a.index).then(function(i){switch(t){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":i.format=n.Nb}if(o.extensions[r.KHR_TEXTURE_TRANSFORM]){var s=void 0!==a.extensions?a.extensions[r.KHR_TEXTURE_TRANSFORM]:void 0;s&&(i=o.extensions[r.KHR_TEXTURE_TRANSFORM].extendTexture(i,s))}e[t]=i})},H.prototype.assignFinalMaterial=function(e){var t=e.geometry,a=e.material,o=this.extensions,i=void 0!==t.attributes.tangent,s=void 0!==t.attributes.color,u=void 0===t.attributes.normal,c=!0===e.isSkinnedMesh,l=Object.keys(t.morphAttributes).length>0,p=l&&void 0!==t.morphAttributes.normal;if(e.isPoints){var d="PointsMaterial:"+a.uuid,f=this.cache.get(d);f||(f=new n.Hb,n.eb.prototype.copy.call(f,a),f.color.copy(a.color),f.map=a.map,f.lights=!1,this.cache.add(d,f)),a=f}else if(e.isLine){d="LineBasicMaterial:"+a.uuid;var h=this.cache.get(d);h||(h=new n.T,n.eb.prototype.copy.call(h,a),h.color.copy(a.color),h.lights=!1,this.cache.add(d,h)),a=h}if(i||s||u||c||l){d="ClonedMaterial:"+a.uuid+":";a.isGLTFSpecularGlossinessMaterial&&(d+="specular-glossiness:"),c&&(d+="skinning:"),i&&(d+="vertex-tangents:"),s&&(d+="vertex-colors:"),u&&(d+="flat-shading:"),l&&(d+="morph-targets:"),p&&(d+="morph-normals:");var v=this.cache.get(d);v||(v=a.isGLTFSpecularGlossinessMaterial?o[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(a):a.clone(),c&&(v.skinning=!0),i&&(v.vertexTangents=!0),s&&(v.vertexColors=n.oc),u&&(v.flatShading=!0),l&&(v.morphTargets=!0),p&&(v.morphNormals=!0),this.cache.add(d,v)),a=v}a.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),t.addAttribute("uv2",new n.g(t.attributes.uv.array,2))),a.isGLTFSpecularGlossinessMaterial&&(e.onBeforeRender=o[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms),e.material=a},H.prototype.loadMaterial=function(e){var t,a=this.json,o=this.extensions,i=a.materials[e],s={},u=i.extensions||{},c=[];if(u[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var l=o[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=l.getMaterialType(i),c.push(l.extendParams(s,i,this))}else if(u[r.KHR_MATERIALS_UNLIT]){var p=o[r.KHR_MATERIALS_UNLIT];t=p.getMaterialType(i),c.push(p.extendParams(s,i,this))}else{t=n.kb;var d=i.pbrMetallicRoughness||{};if(s.color=new n.k(1,1,1),s.opacity=1,Array.isArray(d.baseColorFactor)){var f=d.baseColorFactor;s.color.fromArray(f),s.opacity=f[3]}void 0!==d.baseColorTexture&&c.push(this.assignTexture(s,"map",d.baseColorTexture)),s.metalness=void 0!==d.metallicFactor?d.metallicFactor:1,s.roughness=void 0!==d.roughnessFactor?d.roughnessFactor:1,void 0!==d.metallicRoughnessTexture&&(c.push(this.assignTexture(s,"metalnessMap",d.metallicRoughnessTexture)),c.push(this.assignTexture(s,"roughnessMap",d.metallicRoughnessTexture)))}!0===i.doubleSided&&(s.side=n.v);var h=i.alphaMode||C;return h===A?s.transparent=!0:(s.transparent=!1,h===O&&(s.alphaTest=void 0!==i.alphaCutoff?i.alphaCutoff:.5)),void 0!==i.normalTexture&&t!==n.jb&&(c.push(this.assignTexture(s,"normalMap",i.normalTexture)),s.normalScale=new n.kc(1,1),void 0!==i.normalTexture.scale&&s.normalScale.set(i.normalTexture.scale,i.normalTexture.scale)),void 0!==i.occlusionTexture&&t!==n.jb&&(c.push(this.assignTexture(s,"aoMap",i.occlusionTexture)),void 0!==i.occlusionTexture.strength&&(s.aoMapIntensity=i.occlusionTexture.strength)),void 0!==i.emissiveFactor&&t!==n.jb&&(s.emissive=(new n.k).fromArray(i.emissiveFactor)),void 0!==i.emissiveTexture&&t!==n.jb&&c.push(this.assignTexture(s,"emissiveMap",i.emissiveTexture)),Promise.all(c).then(function(){var e;return e=t===n.Vb?o[r.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new t(s),void 0!==i.name&&(e.name=i.name),e.map&&(e.map.encoding=n.tc),e.emissiveMap&&(e.emissiveMap.encoding=n.tc),e.specularMap&&(e.specularMap.encoding=n.tc),U(e,i),i.extensions&&F(o,e,i),e})},H.prototype.loadGeometries=function(e){var t=this,a=this.extensions,o=this.primitiveCache;function i(e){return a[r.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then(function(r){return N(r,e,t)})}for(var s,u,c=[],l=0,p=e.length;l<p;l++){var d,f=e[l],h=(u=void 0,(u=(s=f).extensions&&s.extensions[r.KHR_DRACO_MESH_COMPRESSION])?"draco:"+u.bufferView+":"+u.indices+":"+k(u.attributes):s.indices+":"+k(s.attributes)+":"+s.mode),v=o[h];if(v)c.push(v.promise);else d=f.extensions&&f.extensions[r.KHR_DRACO_MESH_COMPRESSION]?i(f):N(new n.h,f,t),o[h]={primitive:f,promise:d},c.push(d)}return Promise.all(c)},H.prototype.loadMesh=function(e){for(var t=this,r=this.json,a=(this.extensions,r.meshes[e]),o=a.primitives,i=[],s=0,u=o.length;s<u;s++){var c=void 0===o[s].material?v=v||new n.kb({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:n.D}):this.getDependency("material",o[s].material);i.push(c)}return Promise.all(i).then(function(r){return t.loadGeometries(o).then(function(i){for(var s=[],u=0,c=i.length;u<c;u++){var l,p=i[u],d=o[u],f=r[u];if(d.mode===w||d.mode===T||d.mode===x||void 0===d.mode)!0===(l=!0===a.isSkinnedMesh?new n.Yb(p,f):new n.ib(p,f)).isSkinnedMesh&&l.normalizeSkinWeights(),d.mode===T?l.drawMode=n.hc:d.mode===x&&(l.drawMode=n.gc);else if(d.mode===g)l=new n.V(p,f);else if(d.mode===y)l=new n.S(p,f);else if(d.mode===b)l=new n.U(p,f);else{if(d.mode!==m)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+d.mode);l=new n.Gb(p,f)}Object.keys(l.geometry.morphAttributes).length>0&&j(l,a),l.name=a.name||"mesh_"+e,i.length>1&&(l.name+="_"+u),U(l,a),t.assignFinalMaterial(l),s.push(l)}if(1===s.length)return s[0];var h=new n.H;for(u=0,c=s.length;u<c;u++)h.add(s[u]);return h})})},H.prototype.loadCamera=function(e){var t,r=this.json.cameras[e],a=r[r.type];if(a)return"perspective"===r.type?t=new n.Db(n.fb.radToDeg(a.yfov),a.aspectRatio||1,a.znear||1,a.zfar||2e6):"orthographic"===r.type&&(t=new n.zb(a.xmag/-2,a.xmag/2,a.ymag/2,a.ymag/-2,a.znear,a.zfar)),void 0!==r.name&&(t.name=r.name),U(t,r),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},H.prototype.loadSkin=function(e){var t=this.json.skins[e],r={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(r):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return r.inverseBindMatrices=e,r})},H.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],r=[],a=[],o=[],i=[],s=[],u=0,c=t.channels.length;u<c;u++){var l=t.channels[u],p=t.samplers[l.sampler],d=l.target,f=void 0!==d.node?d.node:d.id,v=void 0!==t.parameters?t.parameters[p.input]:p.input,m=void 0!==t.parameters?t.parameters[p.output]:p.output;r.push(this.getDependency("node",f)),a.push(this.getDependency("accessor",v)),o.push(this.getDependency("accessor",m)),i.push(p),s.push(d)}return Promise.all([Promise.all(r),Promise.all(a),Promise.all(o),Promise.all(i),Promise.all(s)]).then(function(r){for(var a=r[0],o=r[1],i=r[2],s=r[3],u=r[4],c=[],l=0,p=a.length;l<p;l++){var d=a[l],f=o[l],v=i[l],m=s[l],g=u[l];if(void 0!==d){var b;switch(d.updateMatrix(),d.matrixAutoUpdate=!0,L[g.path]){case L.weights:b=n.sb;break;case L.rotation:b=n.Jb;break;case L.position:case L.scale:default:b=n.nc}var y=d.name?d.name:d.uuid,w=void 0!==m.interpolation?_[m.interpolation]:n.P,T=[];L[g.path]===L.weights?d.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&T.push(e.name?e.name:e.uuid)}):T.push(y);for(var x=0,S=T.length;x<S;x++){var M=new b(T[x]+"."+L[g.path],f.array,v.array,w);"CUBICSPLINE"===m.interpolation&&(M.createInterpolant=function(e){return new h(this.times,this.values,this.getValueSize()/3,e)},M.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),c.push(M)}}}var R=void 0!==t.name?t.name:"animation_"+e;return new n.c(R,void 0,c)})},H.prototype.loadNode=function(e){var t=this.json,a=this.extensions,o=this,i=t.meshReferences,s=t.meshUses,u=t.nodes[e];return(!0===u.isBone?Promise.resolve(new n.e):void 0!==u.mesh?o.getDependency("mesh",u.mesh).then(function(e){var t;if(i[u.mesh]>1){var r=s[u.mesh]++;(t=e.clone()).name+="_instance_"+r,t.onBeforeRender=e.onBeforeRender;for(var n=0,a=t.children.length;n<a;n++)t.children[n].name+="_instance_"+r,t.children[n].onBeforeRender=e.children[n].onBeforeRender}else t=e;return void 0!==u.weights&&t.traverse(function(e){if(e.isMesh)for(var t=0,r=u.weights.length;t<r;t++)e.morphTargetInfluences[t]=u.weights[t]}),t}):void 0!==u.camera?o.getDependency("camera",u.camera):u.extensions&&u.extensions[r.KHR_LIGHTS_PUNCTUAL]&&void 0!==u.extensions[r.KHR_LIGHTS_PUNCTUAL].light?o.getDependency("light",u.extensions[r.KHR_LIGHTS_PUNCTUAL].light):Promise.resolve(new n.tb)).then(function(e){if(void 0!==u.name&&(e.name=n.Ib.sanitizeNodeName(u.name)),U(e,u),u.extensions&&F(a,e,u),void 0!==u.matrix){var t=new n.hb;t.fromArray(u.matrix),e.applyMatrix(t)}else void 0!==u.translation&&e.position.fromArray(u.translation),void 0!==u.rotation&&e.quaternion.fromArray(u.rotation),void 0!==u.scale&&e.scale.fromArray(u.scale);return e})},H.prototype.loadScene=function(){function e(t,r,a,o){var i=a.nodes[t];return o.getDependency("node",t).then(function(e){return void 0===i.skin?e:o.getDependency("skin",i.skin).then(function(e){for(var r=[],n=0,a=(t=e).joints.length;n<a;n++)r.push(o.getDependency("node",t.joints[n]));return Promise.all(r)}).then(function(r){for(var a=!0===e.isGroup?e.children:[e],o=0,i=a.length;o<i;o++){for(var s=a[o],u=[],c=[],l=0,p=r.length;l<p;l++){var d=r[l];if(d){u.push(d);var f=new n.hb;void 0!==t.inverseBindMatrices&&f.fromArray(t.inverseBindMatrices.array,16*l),c.push(f)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}s.bind(new n.Xb(u,c),s.matrixWorld)}return e});var t}).then(function(t){r.add(t);var n=[];if(i.children)for(var s=i.children,u=0,c=s.length;u<c;u++){var l=s[u];n.push(e(l,t,a,o))}return Promise.all(n)})}return function(t){var r=this.json,a=this.extensions,o=this.json.scenes[t],i=new n.Tb;void 0!==o.name&&(i.name=o.name),U(i,o),o.extensions&&F(a,i,o);for(var s=o.nodes||[],u=[],c=0,l=s.length;c<l;c++)u.push(e(s[c],i,r,this));return Promise.all(u).then(function(){return i})}}(),e}();var V=n.GLTFLoader;function z(e,t,r,n,a,o,i){try{var s=e[o](i),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function K(e,t){return q.apply(this,arguments)}function q(){var e;return e=regeneratorRuntime.mark(function e(t,r){var a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new n.ec).name=t,a.encoding=r.encoding||n.W,X(t,a,r),e.prev=4,e.next=7,N()(t,{crossorigin:"anonymous"});case 7:return o=e.sent,a.image=o,a.needsUpdate=!0,r.renderer,e.abrupt("return",a);case 14:throw e.prev=14,e.t0=e.catch(4),new Error("Could not load texture ".concat(t));case 17:case"end":return e.stop()}},e,null,[[4,14]])}),(q=function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){z(o,n,a,i,s,"next",e)}function s(e){z(o,n,a,i,s,"throw",e)}i(void 0)})}).apply(this,arguments)}function X(e,t,r){if("boolean"==typeof r.flipY&&(t.flipY=r.flipY),void 0!==r.mapping&&(t.mapping=r.mapping),void 0!==r.format)t.format=r.format;else{var a=e.search(/\.(jpg|jpeg)$/)>0||0===e.search(/^data:image\/jpeg/);t.format=a?n.Nb:n.Kb}r.repeat&&t.repeat.copy(r.repeat),t.wrapS=r.wrapS||n.i,t.wrapT=r.wrapT||n.i,t.minFilter=r.minFilter||n.Y,t.magFilter=r.magFilter||n.X,t.generateMipmaps=!1!==r.generateMipmaps}var Y=r(162),W=r.n(Y);r(242);n.HDRCubeTextureLoader=function(e){this.manager=void 0!==e?e:n.t,this.hdrLoader=new n.RGBELoader},n.HDRCubeTextureLoader.prototype.load=function(e,t,r,a,o){var i=function(e,t,r,n){var a=e[t+3],o=Math.pow(2,a-128)/255;r[n+0]=e[t+0]*o,r[n+1]=e[t+1]*o,r[n+2]=e[t+2]*o},s=function(){var e=new Float32Array(1),t=new Int32Array(e.buffer);function r(r){e[0]=r;var n=t[0],a=n>>16&32768,o=n>>12&2047,i=n>>23&255;return i<103?a:i>142?(a|=31744,a|=(255==i?0:1)&&8388607&n):i<113?a|=((o|=2048)>>114-i)+(o>>113-i&1):(a|=i-112<<10|o>>1,a+=1&o)}return function(e,t,n,a){var o=e[t+3],i=Math.pow(2,o-128)/255;n[a+0]=r(e[t+0]*i),n[a+1]=r(e[t+1]*i),n[a+2]=r(e[t+2]*i)}}(),u=new n.n;u.type=e,u.encoding=e===n.jc?n.Lb:n.W,u.format=e===n.jc?n.Kb:n.Nb,u.minFilter=u.encoding===n.Lb?n.mb:n.X,u.magFilter=u.encoding===n.Lb?n.mb:n.X,u.generateMipmaps=u.encoding!==n.Lb,u.anisotropy=0;var c=this,l=0;function p(r,a,o,p){var d=new n.B(c.manager);d.setPath(c.path),d.setResponseType("arraybuffer"),d.load(t[r],function(t){l++;var o=c.hdrLoader._parser(t);if(o){if(e===n.C){for(var p=o.data.length/4*3,d=new Float32Array(p),f=0;f<p;f++)i(o.data,4*f,d,3*f);o.data=d}else if(e===n.J){p=o.data.length/4*3;var h=new Uint16Array(p);for(f=0;f<p;f++)s(o.data,4*f,h,3*f);o.data=h}if(void 0!==o.image)u[r].images=o.image;else if(void 0!==o.data){var v=new n.s(o.data,o.width,o.height);v.format=u.format,v.type=u.type,v.encoding=u.encoding,v.minFilter=u.minFilter,v.magFilter=u.magFilter,v.generateMipmaps=u.generateMipmaps,u.images[r]=v}6===l&&(u.needsUpdate=!0,a&&a(u))}},o,p)}for(var d=0;d<t.length;d++)p(d,r,a,o);return u},n.HDRCubeTextureLoader.prototype.setPath=function(e){return this.path=e,this};var Q=n.HDRCubeTextureLoader;n.PMREMGenerator=function(){var e,t=((e=new n.Vb({defines:{SAMPLES_PER_LEVEL:20},uniforms:{faceIndex:{value:0},roughness:{value:.5},mapSize:{value:.5},envMap:{value:null},tFlip:{value:-1}},vertexShader:"varying vec2 vUv;\n\t\t\t\tvoid main() {\n\t\t\t\t\tvUv = uv;\n\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\tvarying vec2 vUv;\n\t\t\t\tuniform int faceIndex;\n\t\t\t\tuniform float roughness;\n\t\t\t\tuniform samplerCube envMap;\n\t\t\t\tuniform float mapSize;\n\t\t\t\tuniform float tFlip;\n\t\t\t\t\n\t\t\t\tfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\t\t\t\t\tfloat a = ggxRoughness + 0.0001;\n\t\t\t\t\ta *= a;\n\t\t\t\t\treturn ( 2.0 / a - 2.0 );\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSamplePhong(vec2 uv, mat3 vecSpace, float specPow) {\n\t\t\t\t\tfloat phi = uv.y * 2.0 * PI;\n\t\t\t\t\tfloat cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\n\t\t\t\t\tfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\t\t\t\t\tvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n\t\t\t\t\treturn vecSpace * sampleDir;\n\t\t\t\t}\n\t\t\t\tvec3 ImportanceSampleGGX( vec2 uv, mat3 vecSpace, float Roughness )\n\t\t\t\t{\n\t\t\t\t\tfloat a = Roughness * Roughness;\n\t\t\t\t\tfloat Phi = 2.0 * PI * uv.x;\n\t\t\t\t\tfloat CosTheta = sqrt( (1.0 - uv.y) / ( 1.0 + (a*a - 1.0) * uv.y ) );\n\t\t\t\t\tfloat SinTheta = sqrt( 1.0 - CosTheta * CosTheta );\n\t\t\t\t\treturn vecSpace * vec3(SinTheta * cos( Phi ), SinTheta * sin( Phi ), CosTheta);\n\t\t\t\t}\n\t\t\t\tmat3 matrixFromVector(vec3 n) {\n\t\t\t\t\tfloat a = 1.0 / (1.0 + n.z);\n\t\t\t\t\tfloat b = -n.x * n.y * a;\n\t\t\t\t\tvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n\t\t\t\t\tvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n\t\t\t\t\treturn mat3(b1, b2, n);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvec4 testColorMap(float Roughness) {\n\t\t\t\t\tvec4 color;\n\t\t\t\t\tif(faceIndex == 0)\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 1)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 2)\n\t\t\t\t\t\tcolor = vec4(0.0,0.0,1.0,1.0);\n\t\t\t\t\telse if(faceIndex == 3)\n\t\t\t\t\t\tcolor = vec4(1.0,1.0,0.0,1.0);\n\t\t\t\t\telse if(faceIndex == 4)\n\t\t\t\t\t\tcolor = vec4(0.0,1.0,1.0,1.0);\n\t\t\t\t\telse\n\t\t\t\t\t\tcolor = vec4(1.0,0.0,1.0,1.0);\n\t\t\t\t\tcolor *= ( 1.0 - Roughness );\n\t\t\t\t\treturn color;\n\t\t\t\t}\n\t\t\t\tvoid main() {\n\t\t\t\t\tvec3 sampleDirection;\n\t\t\t\t\tvec2 uv = vUv*2.0 - 1.0;\n\t\t\t\t\tfloat offset = -1.0/mapSize;\n\t\t\t\t\tconst float a = -1.0;\n\t\t\t\t\tconst float b = 1.0;\n\t\t\t\t\tfloat c = -1.0 + offset;\n\t\t\t\t\tfloat d = 1.0 - offset;\n\t\t\t\t\tfloat bminusa = b - a;\n\t\t\t\t\tuv.x = (uv.x - a)/bminusa * d - (uv.x - b)/bminusa * c;\n\t\t\t\t\tuv.y = (uv.y - a)/bminusa * d - (uv.y - b)/bminusa * c;\n\t\t\t\t\tif (faceIndex==0) {\n\t\t\t\t\t\tsampleDirection = vec3(1.0, -uv.y, -uv.x);\n\t\t\t\t\t} else if (faceIndex==1) {\n\t\t\t\t\t\tsampleDirection = vec3(-1.0, -uv.y, uv.x);\n\t\t\t\t\t} else if (faceIndex==2) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, 1.0, uv.y);\n\t\t\t\t\t} else if (faceIndex==3) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -1.0, -uv.y);\n\t\t\t\t\t} else if (faceIndex==4) {\n\t\t\t\t\t\tsampleDirection = vec3(uv.x, -uv.y, 1.0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsampleDirection = vec3(-uv.x, -uv.y, -1.0);\n\t\t\t\t\t}\n\t\t\t\t\tvec3 correctedDirection = vec3( tFlip * sampleDirection.x, sampleDirection.yz );\n\t\t\t\t\tmat3 vecSpace = matrixFromVector( normalize( correctedDirection ) );\n\t\t\t\t\tvec3 rgbColor = vec3(0.0);\n\t\t\t\t\tconst int NumSamples = SAMPLES_PER_LEVEL;\n\t\t\t\t\tvec3 vect;\n\t\t\t\t\tfloat weight = 0.0;\n\t\t\t\t\tfor( int i = 0; i < NumSamples; i ++ ) {\n\t\t\t\t\t\tfloat sini = sin(float(i));\n\t\t\t\t\t\tfloat cosi = cos(float(i));\n\t\t\t\t\t\tfloat r = rand(vec2(sini, cosi));\n\t\t\t\t\t\tvect = ImportanceSampleGGX(vec2(float(i) / float(NumSamples), r), vecSpace, roughness);\n\t\t\t\t\t\tfloat dotProd = dot(vect, normalize(sampleDirection));\n\t\t\t\t\t\tweight += dotProd;\n\t\t\t\t\t\tvec3 color = envMapTexelToLinear(textureCube(envMap, vect)).rgb;\n\t\t\t\t\t\trgbColor.rgb += color;\n\t\t\t\t\t}\n\t\t\t\t\trgbColor /= float(NumSamples);\n\t\t\t\t\t//rgbColor = testColorMap( roughness ).rgb;\n\t\t\t\t\tgl_FragColor = linearToOutputTexel( vec4( rgbColor, 1.0 ) );\n\t\t\t\t}",blending:n.qb})).type="PMREMGenerator",e),r=new n.zb(-1,1,1,-1,0,1e3),a=new n.Tb,o=new n.ib(new n.Eb(2,2,0),t);o.material.side=n.v,a.add(o),a.add(r);var i=function(e,t,r){this.sourceTexture=e,this.resolution=void 0!==r?r:256,this.samplesPerLevel=void 0!==t?t:32;var a=this.sourceTexture.encoding===n.W||this.sourceTexture.encoding===n.F||this.sourceTexture.encoding===n.tc;this.sourceTexture.minFilter=a?n.X:n.mb,this.sourceTexture.magFilter=a?n.X:n.mb,this.sourceTexture.generateMipmaps=this.sourceTexture.generateMipmaps&&a,this.cubeLods=[];var o=this.resolution,i={format:this.sourceTexture.format,magFilter:this.sourceTexture.magFilter,minFilter:this.sourceTexture.minFilter,type:this.sourceTexture.type,generateMipmaps:this.sourceTexture.generateMipmaps,anisotropy:this.sourceTexture.anisotropy,encoding:this.sourceTexture.encoding};this.numLods=Math.log(o)/Math.log(2)-2;for(var s=0;s<this.numLods;s++){var u=new n.qc(o,o,i);u.texture.name="PMREMGenerator.cube"+s,this.cubeLods.push(u),o=Math.max(16,o/2)}};return i.prototype={constructor:i,update:function(e){var r=this.sourceTexture.isCubeTexture?-1:1;t.defines.SAMPLES_PER_LEVEL=this.samplesPerLevel,t.uniforms.faceIndex.value=0,t.uniforms.envMap.value=this.sourceTexture,t.envMap=this.sourceTexture,t.needsUpdate=!0;var a=e.gammaInput,o=e.gammaOutput,i=e.toneMapping,s=e.toneMappingExposure,u=e.getRenderTarget();e.toneMapping=n.ab,e.toneMappingExposure=1,e.gammaInput=!1,e.gammaOutput=!1;for(var c=0;c<this.numLods;c++){var l=c/(this.numLods-1);t.uniforms.roughness.value=.9*l,t.uniforms.tFlip.value=0==c?r:1;var p=this.cubeLods[c].width;t.uniforms.mapSize.value=p,this.renderToCubeMapTarget(e,this.cubeLods[c]),c<5&&(t.uniforms.envMap.value=this.cubeLods[c].texture)}e.setRenderTarget(u),e.toneMapping=i,e.toneMappingExposure=s,e.gammaInput=a,e.gammaOutput=o},renderToCubeMapTarget:function(e,t){for(var r=0;r<6;r++)this.renderToCubeMapTargetFace(e,t,r)},renderToCubeMapTargetFace:function(e,n,o){t.uniforms.faceIndex.value=o,e.setRenderTarget(n,o),e.clear(),e.render(a,r)},dispose:function(){for(var e=0,t=this.cubeLods.length;e<t;e++)this.cubeLods[e].dispose()}},i}();var J=n.PMREMGenerator;n.PMREMCubeUVPacker=function(){var e,t=new n.zb,r=new n.Tb,a=((e=new n.Vb({uniforms:{faceIndex:{value:0},mapSize:{value:0},envMap:{value:null},testColor:{value:new n.lc(1,1,1)}},vertexShader:"precision highp float;        varying vec2 vUv;        void main() {          vUv = uv;          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );        }",fragmentShader:"precision highp float;        varying vec2 vUv;        uniform samplerCube envMap;        uniform float mapSize;        uniform vec3 testColor;        uniform int faceIndex;                void main() {          vec3 sampleDirection;          vec2 uv = vUv;          uv = uv * 2.0 - 1.0;          uv.y *= -1.0;          if(faceIndex == 0) {            sampleDirection = normalize(vec3(1.0, uv.y, -uv.x));          } else if(faceIndex == 1) {            sampleDirection = normalize(vec3(uv.x, 1.0, uv.y));          } else if(faceIndex == 2) {            sampleDirection = normalize(vec3(uv.x, uv.y, 1.0));          } else if(faceIndex == 3) {            sampleDirection = normalize(vec3(-1.0, uv.y, uv.x));          } else if(faceIndex == 4) {            sampleDirection = normalize(vec3(uv.x, -1.0, -uv.y));          } else {            sampleDirection = normalize(vec3(-uv.x, uv.y, -1.0));          }          vec4 color = envMapTexelToLinear( textureCube( envMap, sampleDirection ) );          gl_FragColor = linearToOutputTexel( color );        }",blending:n.qb})).type="PMREMCubeUVPacker",e),o=function(e){this.cubeLods=e;var t=4*e[0].width,r=e[0].texture,o={format:r.format,magFilter:r.magFilter,minFilter:r.minFilter,type:r.type,generateMipmaps:r.generateMipmaps,anisotropy:r.anisotropy,encoding:r.encoding===n.Lb?n.Ob:r.encoding};o.encoding===n.Ob&&(o.magFilter=n.X,o.minFilter=n.X),this.CubeUVRenderTarget=new n.pc(t,t,o),this.CubeUVRenderTarget.texture.name="PMREMCubeUVPacker.cubeUv",this.CubeUVRenderTarget.texture.mapping=n.p,this.objects=[];var i=new n.Eb(1,1),s=[];s.push(new n.kc(0,0)),s.push(new n.kc(1,0)),s.push(new n.kc(2,0)),s.push(new n.kc(0,1)),s.push(new n.kc(1,1)),s.push(new n.kc(2,1));var u=t;t=e[0].width;var c=0,l=4;this.numLods=Math.log(e[0].width)/Math.log(2)-2;for(var p=0;p<this.numLods;p++){var d=.5*(u-u/l);t>16&&(l*=2);for(var f=t>16?6:1,h=0,v=0,m=t,g=0;g<f;g++){for(var b=0;b<6;b++){var y=a.clone();y.uniforms.envMap.value=this.cubeLods[p].texture,y.envMap=this.cubeLods[p].texture,y.uniforms.faceIndex.value=b,y.uniforms.mapSize.value=m;var w=new n.ib(i,y);w.position.x=s[b].x*m-d+h,w.position.y=s[b].y*m-d+c+v,w.material.side=n.d,w.scale.setScalar(m),this.objects.push(w)}v+=1.75*m,h+=1.25*m,m/=2}c+=2*t,t>16&&(t/=2)}};return o.prototype={constructor:o,update:function(e){var a=4*this.cubeLods[0].width;t.left=.5*-a,t.right=.5*a,t.top=.5*-a,t.bottom=.5*a,t.near=0,t.far=1,t.updateProjectionMatrix();for(var o=0;o<this.objects.length;o++)r.add(this.objects[o]);var i=e.gammaInput,s=e.gammaOutput,u=e.toneMapping,c=e.toneMappingExposure,l=e.getRenderTarget();e.gammaInput=!1,e.gammaOutput=!1,e.toneMapping=n.ab,e.toneMappingExposure=1,e.setRenderTarget(this.CubeUVRenderTarget),e.render(r,t),e.setRenderTarget(l),e.toneMapping=u,e.toneMappingExposure=c,e.gammaInput=i,e.gammaOutput=s;for(o=0;o<this.objects.length;o++)r.remove(this.objects[o])},dispose:function(){for(var e=0,t=this.objects.length;e<t;e++)this.objects[e].material.dispose();this.objects[0].geometry.dispose()}},o}();var Z=n.PMREMCubeUVPacker;n.CubemapGenerator=function(e){this.renderer=e},n.CubemapGenerator.prototype.fromEquirectangular=function(e,t){t=t||{};var r=new n.Tb,a={tEquirect:{value:null}},o="\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t//include <common>\n\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t#include <begin_vertex>\n\t\t\t\t#include <project_vertex>\n\n\t\t\t}\n\t\t\t",i="\n\t\t\tuniform sampler2D tEquirect;\n\n\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t//include <common>\n\t\t\t#define RECIPROCAL_PI 0.31830988618\n\t\t\t#define RECIPROCAL_PI2 0.15915494\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\tvec2 sampleUV;\n\n\t\t\t\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\t\t\t\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t}\n\t\t\t",s=new n.Vb({type:"CubemapFromEquirect",uniforms:n.ic.clone(a),vertexShader:o,fragmentShader:i,side:n.d,blending:n.qb});s.uniforms.tEquirect.value=e;var u=new n.ib(new n.f(5,5,5),s);r.add(u);var c=t.resolution||512,l={type:e.type,format:e.format,encoding:e.encoding,generateMipmaps:void 0!==t.generateMipmaps?t.generateMipmaps:e.generateMipmaps,minFilter:void 0!==t.minFilter?t.minFilter:e.minFilter,magFilter:void 0!==t.magFilter?t.magFilter:e.magFilter},p=new n.m(1,10,c,l);return p.update(this.renderer,r),u.geometry.dispose(),u.material.dispose(),p.renderTarget},n.EquirectangularToCubeGenerator=function(){var e,t=new n.Db(90,1,.1,10),r=new n.Tb,a=new n.ib(new n.f(1,1,1),((e=new n.Vb({uniforms:{equirectangularMap:{value:null}},vertexShader:"varying vec3 localPosition;\n        \n        void main() {\n          localPosition = position;\n          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n        }",fragmentShader:"#include <common>\n        varying vec3 localPosition;\n        uniform sampler2D equirectangularMap;\n        \n        vec2 EquirectangularSampleUV(vec3 v) {\n          vec2 uv = vec2(atan(v.z, v.x), asin(v.y));\n          uv *= vec2(0.1591, 0.3183); // inverse atan\n          uv += 0.5;\n          return uv;\n        }\n        \n        void main() {\n          vec2 uv = EquirectangularSampleUV(normalize(localPosition));\n          gl_FragColor = texture2D(equirectangularMap, uv);\n        }",blending:n.qb})).type="EquirectangularToCubeGenerator",e));a.material.side=n.d,r.add(a);var o=function(e,t){t=t||{},this.sourceTexture=e,this.resolution=t.resolution||512,this.views=[{t:[1,0,0],u:[0,-1,0]},{t:[-1,0,0],u:[0,-1,0]},{t:[0,1,0],u:[0,0,1]},{t:[0,-1,0],u:[0,0,-1]},{t:[0,0,1],u:[0,-1,0]},{t:[0,0,-1],u:[0,-1,0]}];var r={format:t.format||this.sourceTexture.format,magFilter:this.sourceTexture.magFilter,minFilter:this.sourceTexture.minFilter,type:t.type||this.sourceTexture.type,generateMipmaps:this.sourceTexture.generateMipmaps,anisotropy:this.sourceTexture.anisotropy,encoding:this.sourceTexture.encoding};this.renderTarget=new n.qc(this.resolution,this.resolution,r)};return o.prototype={constructor:o,update:function(e){var n=e.getRenderTarget();a.material.uniforms.equirectangularMap.value=this.sourceTexture;for(var o=0;o<6;o++){var i=this.views[o];t.position.set(0,0,0),t.up.set(i.u[0],i.u[1],i.u[2]),t.lookAt(i.t[0],i.t[1],i.t[2]),e.setRenderTarget(this.renderTarget,o),e.clear(),e.render(r,t)}return e.setRenderTarget(n),this.renderTarget.texture},dispose:function(){this.renderTarget.dispose()}},o}();var $=n.EquirectangularToCubeGenerator;function ee(e,t,r,n,a,o,i){try{var s=e[o](i),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function te(e,t){return re.apply(this,arguments)}function re(){var e;return e=regeneratorRuntime.mark(function e(t,r){var a,o,i,s,u,c,l,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=r.renderer){e.next=3;break}throw new Error("PBR Map requires renderer to passed in the options for ".concat(t,"!"));case 3:if(!r.equirectangular){e.next=13;break}return e.next=6,K(t,{renderer:a});case 6:return o=e.sent,i=new $(o,{resolution:1024}),(s=i.update(a)).renderTarget=i.renderTarget,o.dispose(),o.image.data=null,e.abrupt("return",ne(s,r));case 13:if(u=t,c=r.hdr,l=c?".hdr":".png",d="".concat(u.replace(/\/$/,""),"/"),f=l,p=["".concat(d,"px").concat(f),"".concat(d,"nx").concat(f),"".concat(d,"py").concat(f),"".concat(d,"ny").concat(f),"".concat(d,"pz").concat(f),"".concat(d,"nz").concat(f)],!c){e.next=19;break}return e.abrupt("return",new Promise(function(e,t){(new Q).load(n.jc,p,function(t){return e(ne(t,r))},null,function(){return t(new Error("Could not load PBR map: ".concat(u)))})}));case 19:return e.abrupt("return",new Promise(function(e,t){(new n.o).load(p,function(t){t.encoding=n.Ob,e(ne(t,r))},null,function(){return t(new Error("Could not load PBR map: ".concat(u)))})}));case 20:case"end":return e.stop()}var d,f},e)}),(re=function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){ee(o,n,a,i,s,"next",e)}function s(e){ee(o,n,a,i,s,"throw",e)}i(void 0)})}).apply(this,arguments)}function ne(e,t){if(t.pbr||"number"==typeof t.level){var r=new J(e);if(r.update(t.renderer),t.pbr){var n=new Z(r.cubeLods);n.update(t.renderer),e=n.CubeUVRenderTarget.texture,n.dispose()}else{var a=W()(Math.floor(t.level),0,r.cubeLods.length);e=r.cubeLods[a].texture}r.dispose()}return t.mapping&&(e.mapping=t.mapping),e}function ae(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function oe(e,t,r,n,a,o,i){try{var s=e[o](i),u=s.value}catch(e){return void r(e)}s.done?t(u):Promise.resolve(u).then(n,a)}function ie(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function i(e){oe(o,n,a,i,s,"next",e)}function s(e){oe(o,n,a,i,s,"throw",e)}i(void 0)})}}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){ue(e,t,r[t])})}return e}function ue(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ce(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function le(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function pe(e,t){if(!Object.prototype.hasOwnProperty.call(e,t))throw new TypeError("attempted to use private field on non-instance");return e}var de=0;function fe(e){return"__private_"+de+++"_"+e}var he=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.defineProperty(this,ve,{writable:!0,value:[]}),Object.defineProperty(this,me,{writable:!0,value:{}}),Object.defineProperty(this,ge,{writable:!0,value:[]}),Object.defineProperty(this,be,{writable:!0,value:10}),Object.defineProperty(this,ye,{writable:!0,value:[]}),this.get=function(e){if(!e)throw new TypeError("Must specify an URL for AssetManager.get()");if(!(e in pe(t,me)[me]))throw new Error("The asset ".concat(e," is not in the loaded files."));return pe(t,me)[me][e]}}var t,r,n;return t=e,(r=[{key:"addProgressListener",value:function(e){if("function"!=typeof e)throw new TypeError("onProgress must be a function");pe(this,ge)[ge].push(e)}},{key:"queue",value:function(e){var t=e.url,r=e.type,n=ce(e,["url","type"]);if(!t)throw new TypeError("Must specify a URL or opt.url for AssetManager.queue()");return this._getQueued(t)||pe(this,ve)[ve].push(se({url:t,type:r||this._extractType(t)},n)),t}},{key:"_getQueued",value:function(e){return pe(this,ve)[ve].find(function(t){return t.url===e})}},{key:"_extractType",value:function(e){var t=e.slice(e.lastIndexOf("."));switch(!0){case/\.(gltf|glb)$/i.test(t):return"gltf";case/\.json$/i.test(t):return"json";case/\.svg$/i.test(t):return"svg";case/\.(jpe?g|png|gif|bmp|tga|tif)$/i.test(t):return"image";case/\.(wav|mp3)$/i.test(t):return"audio";case/\.(mp4|webm|ogg|ogv)$/i.test(t):return"video";default:throw new Error("Could not load ".concat(e,", unknown file extension!"))}}},{key:"loadSingle",value:function(){var e=ie(regeneratorRuntime.mark(function e(t){var r,n,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.renderer,n=ce(t,["renderer"]),r){e.next=3;break}throw new Error("You must provide a renderer to the loadSingle function.");case 3:return e.prev=3,a=Date.now(),e.next=7,this._loadItem(se({renderer:r},n));case 7:return pe(this,me)[me][n.url]=e.sent,window.DEBUG&&console.log("\ud83d\udce6 Loaded single asset %c".concat(n.url,"%c in ").concat(G()(Date.now()-a)),"color:blue","color:black"),e.abrupt("return",n.url);case 12:e.prev=12,e.t0=e.catch(3),delete pe(this,me)[me][n.url],console.error("\ud83d\udce6  Could not load ".concat(n.url,":\n").concat(e.t0));case 16:case"end":return e.stop()}},e,this,[[3,12]])}));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=ie(regeneratorRuntime.mark(function e(t){var r,n,a,o,i,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.renderer){e.next=3;break}throw new Error("You must provide a renderer to the load function.");case 3:if(n=pe(this,ve)[ve].slice(),pe(this,ve)[ve].length=0,0!==(a=n.length)){e.next=9;break}return setTimeout(function(){return pe(s,ge)[ge].forEach(function(e){return e(1)})},0),e.abrupt("return");case 9:return o=Date.now(),e.next=12,j()(n,function(){var e=ie(regeneratorRuntime.mark(function e(t,n){var o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,o=Date.now(),e.next=4,s._loadItem(se({renderer:r},t));case 4:pe(s,me)[me][t.url]=e.sent,window.DEBUG&&s.log("Loaded %c".concat(t.url,"%c in ").concat(G()(Date.now()-o)),"color:blue","color:black"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),s.logError("Skipping ".concat(t.url," from asset loading:\n").concat(e.t0));case 11:i=(n+1)/a,pe(s,ge)[ge].forEach(function(e){return e(i)});case 13:case"end":return e.stop()}},e,null,[[0,8]])}));return function(t,r){return e.apply(this,arguments)}}(),{concurrency:pe(this,be)[be]});case 12:window.DEBUG&&(i=pe(this,ye)[ye].filter(function(e){return"error"===e.type}),this.groupLog("\ud83d\udce6 Assets loaded in ".concat(G()(Date.now()-o)," \u23f1 ").concat(i.length>0?"%c \u26a0\ufe0f Skipped ".concat(i.length," asset").concat(i.length>1?"s":""," "):""),i.length>0?"color:white;background:red;":""));case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"_loadItem",value:function(){var e=ie(regeneratorRuntime.mark(function e(t){var r,n,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.url,n=t.type,a=t.renderer,o=ce(t,["url","type","renderer"]),!(r in pe(this,me)[me])){e.next=3;break}return e.abrupt("return",pe(this,me)[me][r]);case 3:e.t0=n,e.next="gltf"===e.t0?6:"json"===e.t0?7:"env-map"===e.t0?8:"svg"===e.t0?9:"image"===e.t0?9:"texture"===e.t0?10:"audio"===e.t0?11:"video"===e.t0?12:13;break;case 6:return e.abrupt("return",new Promise(function(e,t){(new V).load(r,e,null,function(e){return t(new Error("Could not load GLTF asset ".concat(r,":\n").concat(e)))})}));case 7:return e.abrupt("return",fetch(r).then(function(e){return e.json()}));case 8:return e.abrupt("return",te(r,se({renderer:a},o)));case 9:return e.abrupt("return",N()(r,{crossorigin:"anonymous"}));case 10:return e.abrupt("return",K(r,se({renderer:a},o)));case 11:return e.abrupt("return",fetch(r).then(function(e){return e.arrayBuffer()}));case 12:return e.abrupt("return",fetch(r).then(function(e){return e.blob()}));case 13:throw new Error("Could not load ".concat(r,", the type ").concat(n," is unknown!"));case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];pe(this,ye)[ye].push({type:"log",text:t})}},{key:"logError",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];pe(this,ye)[ye].push({type:"error",text:t})}},{key:"groupLog",value:function(){var e;(e=console).groupCollapsed.apply(e,arguments),pe(this,ye)[ye].forEach(function(e){var t;(t=console)[e.type].apply(t,ae(e.text))}),console.groupEnd(),pe(this,ye)[ye].length=0}}])&&le(t.prototype,r),n&&le(t,n),e}(),ve=fe("queue"),me=fe("cache"),ge=fe("onProgressListeners"),be=fe("asyncConcurrency"),ye=fe("logs"),we=new he;r(243),r(244);function Te(e){return(Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function Se(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Me(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function Re(e,t){return!t||"object"!==Te(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ee(e){return(Ee=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Pe(e,t){return(Pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Le=we.queue({url:"assets/suzanne.gltf",type:"gltf"}),_e=we.queue({url:"assets/spotty-metal/albedo.jpg",type:"texture"}),Ce=we.queue({url:"assets/spotty-metal/metalness.jpg",type:"texture"}),Oe=we.queue({url:"assets/spotty-metal/roughness.jpg",type:"texture"}),Ae=we.queue({url:"assets/spotty-metal/normal.jpg",type:"texture"}),De=we.queue({url:"assets/ouside-afternoon-blurred-hdr.jpg",type:"env-map",equirectangular:!0}),Ie=function(e){function t(e){var r,a=e.webgl,o=Se(e,["webgl"]);!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Re(this,Ee(t).call(this,o))).webgl=a;var i=we.get(Le).scene.clone(),s=new n.kb({map:we.get(_e),metalnessMap:we.get(Ce),roughnessMap:we.get(Oe),normalMap:we.get(Ae),normalScale:new n.kc(1.5,1.5),envMap:we.get(De),envMapIntensity:1});return i.traverse(function(e){e.isMesh&&(e.material=s)}),i.scale.multiplyScalar(1.2),r.add(i),r.webgl.scene.background=we.get(De).renderTarget,r}var r,a,o;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pe(e,t)}(t,n["H"]),r=t,(a=[{key:"onPointerDown",value:function(e,t){var r=xe(t,2),a=r[0],o=r[1],i=(new n.kc).set(a/this.webgl.width*2-1,-o/this.webgl.height*2+1),s=new n.Pb;s.setFromCamera(i,this.webgl.camera);var u=s.intersectObject(this,!0);console.log(u.length>0?"Hit ".concat(u[0].object.name,"!"):"No hit")}},{key:"onPointerMove",value:function(e,t){var r=xe(t,2);r[0],r[1]}},{key:"onPointerUp",value:function(e,t){var r=xe(t,2);r[0],r[1]}},{key:"update",value:function(e,t){this.rotation.y+=e*this.webgl.controls.angularVelocity}}])&&Me(r.prototype,a),o&&Me(r,o),t}();window.DEBUG=window.location.search.includes("debug");var Fe=new O({canvas:document.querySelector("#app"),alpha:!0,background:"#000",backgroundAlpha:1,postprocessing:!0,showFps:window.DEBUG,orbitControls:window.DEBUG&&{distance:5},controls:{angularVelocity:o.a.Slider(.5,{label:"Angular Velocity",min:.1,max:30,step:.1})},hideControls:!window.DEBUG});window.DEBUG&&(window.webgl=Fe),Fe.canvas.style.visibility="hidden",we.load({renderer:Fe.renderer}).then(function(){Fe.canvas.style.visibility="",Fe.camera.position.set(0,0,5),Fe.scene.suzanne=new Ie({webgl:Fe}),Fe.scene.add(Fe.scene.suzanne),function(e){var t=new n.K(16777215,16777215,.6);t.color.setHSL(.6,1,.6),t.groundColor.setHSL(.095,1,.75),t.position.set(0,50,0),e.scene.add(t);var r=new n.u(16777215,1);r.color.setHSL(.1,1,.95),r.position.set(3,5,1),r.position.multiplyScalar(50),e.scene.add(r),r.castShadow=!0,r.shadow.mapSize.width=2048,r.shadow.mapSize.height=2048,r.shadow.camera.left=-50,r.shadow.camera.right=50,r.shadow.camera.top=50,r.shadow.camera.bottom=-50,r.shadow.camera.far=3500,r.shadow.bias=-1e-4}(Fe);var e,t,r=new T({vertexShader:"#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"#define GLSLIFY 1\nfloat vignette(vec2 uv, float radius, float smoothness) {\n\tfloat diff = radius - distance(uv, vec2(0.5, 0.5));\n\treturn smoothstep(-smoothness, smoothness, diff);\n}\n\nuniform sampler2D tDiffuse;\nvarying vec2 vUv;\n\nvoid main() {\n  vec4 texColor = texture2D(tDiffuse, vUv);\n\n  float vignetteValue = vignette(vUv, 0.5, 0.5);\n  texColor.rgb *= vignetteValue;\n\n  gl_FragColor = texColor;\n}\n",uniforms:{tDiffuse:{type:"t",value:new n.ec}}});Fe.composer.addPass(r),window.DEBUG&&(e=Fe,(t=document.createElement("div")).style.position="fixed",t.style.bottom=0,t.style.right=0,t.style.background="tomato",t.style.cursor="pointer",t.style.padding="8px 16px",t.style.color="white",t.style.fontSize="24px",t.textContent="Save screenshot",document.body.appendChild(t),t.addEventListener("click",e.saveScreenshot)),Fe.start(),Fe.draw()})}});
//# sourceMappingURL=app.4284d5e7.js.map